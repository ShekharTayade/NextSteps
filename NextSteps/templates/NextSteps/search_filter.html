
<!-- READ THE INSTRUCTIONS BELOW BEFORE USING THIS TEMPLATE
 1. Start your page with this template and modify. Rename this template with HTML name and then modify.
 2. We keep as it is the header portion of the page (which is top hidden block and the navigation) 
    and the footer portion (footer block) on each page.
 3. Override only the "slide-show", "features", and "jointhem-blog" blocks on each page
 4. Keep the top "hidden" clock and the nav-bar as it is, which forms the header section of the page.
 5. Overriding the parent blocks will start from "slide-show" block 
 6. Keep the <div>s  given below as it is in the "slide-show" and "features" blocks to keep the same styling matching the home page. 
    If overriding the parent block without any content then remove the <div>s too, just keep block and endblock. 
 7. For most of the pages, you can keep the title of the page in "slide-show" block and put all the content in "features" block. 
    The "jointhem-blog" block can be kept empty.
 8. PLEASE REMEBER :- 
    TO OVERRIDE A BLOCK USE THE CORRESPONDING BLOCK AND <div>s, 
    TO KEEP THE BLOCK EMPTY JUST USE THE BLOCK OPEN AND ENDBLOCK, 
    AND TO KEEP ABLOCK AS IT IS DON'T USE THE BLOCK NAMES HERE SO THOSE BLOCKS FROM PARENT WILL BE USED AS IT IS. 
 -->

<!-- Extend the home page to keep the same styling for header and footer sections. -->
{% extends 'NextSteps/NextSteps.html' %}

<!-- Override slide-show block from parent -->
{% block slide-show %}

{% endblock slide-show %}

<!-- Override features block -->
{% block features %}

    <div class="showcase block block-border-bottom-grey">
        <div class="container">

        <h3 class="block-title">Select Filter to Research Institutes</h3>

            <!-- the contents of this form are not visible except for the "Submit" button. The form items are set via the script and are submitted to the request -->
            <form action="{% url 'Search_Instts' %}" method='post' id='SubmitSearch'>

                <div class="panel panel-info">
                    <div class="panel-heading">
                        <h5 class="panel-title">
                            Instructions for Search</h5>
                        <span class="pull-right clickable"><i class="glyphicon glyphicon-minus"></i></span>
                    </div>
                    <div class="panel-body">
                        <ul>
                            <li>Please use the State and City tabs below to narrow your search for Institutes. </li>
                            <li>After you have made the selections please click the "Get Institutes" button to obtain the list of Institutions.</li>
                        </ul>
                    </div>
                </div>

                <button class='btn btn-more' type='submit' formmethod='post' value='submit' form = 'SubmitSearch' onclick= "getAllSelectedValues()"> <i class="fa fa-plus"></i> Get Institutes</button>
                {% csrf_token %}
    
                <!-- creating an invisible form items to submit the search filters to the view "SearchInstts-->
                <input style="display:none;" class="form-control" type="text" id="StateSelections_nv" name='StateValues'>
                <input style="display:none;" class="form-control" type="text" id="CitySelections_nv" name='CityValues'>
                <input style="display:none;" class="form-control" type="text" id="TypeSelections_nv" name='TypeValues'>
            </form>

            <div class="block">
                <div class="row" style="margin-left:-5px">
                        <ul class="nav nav-tabs">
                            <li style="display:none"><a href="#country" data-toggle="tab" class="text-fancy"><i class="fa fa fa-globe"></i>Geography</a></li>
                            <li style="display:none"><a href="#discipline" data-toggle="tab" class="text-fancy"><i class="fa fa fa-list"></i>Discipline</a></li>
                            <li style="display:none"><a href="#level" data-toggle="tab" class="text-fancy"><i class="fa fa-graduation-cap"></i>Level</a></li>
                            <li class="active"><a href="#state" data-toggle="tab" class="text-fancy"><i class="fa fa-fw fa-map"></i>State</a></li>
                            <li><a href="#city" id= "Scity" data-toggle="tab" class="text-fancy"><i class="fa fa-fw fa-map-marker"></i>City</a></li>
                            <li style="display:none"><a href="#insttype" data-toggle="tab" class="text-fancy"><i class="fa fa-fw fa-university"></i>Instt Type</a></li>
                        </ul>
                            
                        <div class="tab-content">

                            <!--  Country to be enabled later on -->
                            <div class="tab-pane" id="country">
                        
                                    <div>
                                        <p style="#a9a9a9">Selections:&nbsp;<i class='text-primary' id="CountrySelections"></i></p>
                                                                                        
                                        <select  id="countryList" style= "list-style:none; min-width:350px" multiple='multiple' size='10' onkeyup = "getMultipleSelectedValue('Country')" ontouchend="getMultipleSelectedValue('Country')"  onclick="getMultipleSelectedValue('Country')" > 
                                        </select>           
                                    </div>
        
                            </div>
                        
                        
                            <!--  Discipline to be enabled later on -->
                            <div class="tab-pane" id="discipline">
                        
                                    <div>
                                        <p style="#a9a9a9">Selections:&nbsp;<i class='text-primary' id="DisciplineSelections"></i></p>
                                                                                        
                                        <select  id="disciplineList" style= "list-style:none; min-width:350px" multiple='multiple' size='10' onkeyup = "getMultipleSelectedValue('Discipline')" ontouchend="getMultipleSelectedValue('Discipline')"  onclick="getMultipleSelectedValue('Discipline')" > 
                                        </select>           
                                    </div>
        
                            </div>
                            
                            
                            <!--  Level to be enabled later on -->
                            <div class="tab-pane" id="level">
                        
                                    <div>
                                        <p style="#a9a9a9">Selections:&nbsp;<i class='text-primary' id="LevelSelections"></i></p>
                                                                                        
                                        <select  id="levelList" style= "list-style:none; min-width:350px" multiple='multiple' size='10' onkeyup = "getMultipleSelectedValue('Level')" ontouchend="getMultipleSelectedValue('Level')"  onclick="getMultipleSelectedValue('Level')" > 
                                        </select>           
                                    </div>
        
                            </div>

                            

                            <div class="tab-pane active" id="state">
                        
                                {% if instt_StateList %}
                                    <div>
                                        <p style="#a9a9a9">Selections:&nbsp;<i class='text-primary' id="StateSelections"></i></p>
                                                                                        
                                        <select  id="stateList" style= "list-style:none; min-width:350px; max-width:475px;" multiple='multiple' size='10' onkeyup = "getMultipleSelectedValue('State')" onchange="getMultipleSelectedValue('State')"  onclick="getMultipleSelectedValue('State')" > 
                                            {% for il in instt_StateList %}
                                                <option class = "list-group-item" style="list-style: none;">{{il.state}}</option> 
                                            {% endfor %}    
                                        </select>           
                                    </div>
        
                                {% else %}
                                    <p>Something wrong here, no states found. Please report it using the contact form below.</p>
                                {% endif %}
        
                            </div>
                            <div class="tab-pane" id="city">
                    
                                {% if instt_CityList %}
                                    <div>
                                        <p style="#a9a9a9">Selections:&nbsp;<i class='text-primary' id="CitySelections"></i></p>
                                                
                                        <select id="cityList" class="list-group"  style= "list-style:none; min-width:350px;" multiple='multiple' size='10' onkeyup = "getMultipleSelectedValue('City')" onclick ="getMultipleSelectedValue('City')">
                                            {% for il in instt_CityList %}
                                                <option class = "list-group-item" style="list-style: none;"> {{ il.city }} </option>
                                            {% endfor %}    
                                        </select>           
                                    </div>
                                {% else %}
                                    <p>Something wrong here, no cities found. Please report it using the contact form below.</p>
                                {% endif %}                
                    
                            </div>
        
        
                            <div class="tab-pane" id="insttype">
        
                                {% if instt_typeList %}
                                    <div>                                        
                                        <p style="#a9a9a9">Selections:&nbsp;<i class='text-primary' id="TypeSelections"></i></p>
    
                                        <select class="list-group" id="typeList" style= "list-style : none; min-width:350px" multiple='multiple' size='6' onkeyup = "getMultipleSelectedValue('Type')" onclick ="getMultipleSelectedValue('Type')">
                                            {% for il in instt_typeList %}
                                                <option class = "list-group-item" style="list-style: none;"> {{ il.description }} </option>
                                            {% endfor %}    
                                        </select>           
                                    </div>
                                {% else %}
                                    <p>Something wrong here, no types found. Please report it using the contact form below.</p>
                                {% endif %}                
                            </div>
    
                        </div>
                    </div>
                </div>
            </div>
        </div>

    <!-- loading Jquery is required for following scripts to run-->

    {% load static %}
    <script src="{% static 'lib/jquery/jquery.min.js' %}"></script>

    <!-- Script to dynamically change the city list based on the selected states -->
    <!-- This script makes an AJAX call to the server with the state list as parameters and get the city list in return -->
    <script>
        $("#Scity").focus(function () {
            var sl = $("#StateSelections_nv").val();
        $.ajax({
            url: '{% url "Get_Cities" %}',
            data: {
            'stateList': sl
            },
            dataType: 'json',
            success: function (data) {
                
                var txt = "<p style='#a9a9a9'>Selections:\&nbsp;<i class='text-primary' id='CitySelections'></i></p>";
                txt += "<select id='cityList' class='list-group' style= 'list-style : none; min-width:350px;' multiple='multiple' size='10' onkeyup = 'getMultipleSelectedValue(\"City\")' onclick ='getMultipleSelectedValue(\"City\")'>";
                $.each(data, function(index, element) {
                    txt += "<option class = 'list-group-item' style='list-style: none;'>" + data[index].city + "</option>";
                });
                txt += "</select>"; 
                
                $("#city").html(txt);                        
                $("#CitySelections_nv").val("");

            }
        });
        })          
            
    </script>

    <!-- Set the city form input value to blank when the state is changed -->
    <script>

        $("#stateList").change(function () {
            $("#CitySelections_nv").val("");
            getAllSelectedValues();
        })
    </script>    

    <script>
        document.addEventListener('DOMContentLoaded', function() {
                document.querySelector("#stateList").onchange=changeEventHandler;
        },false);


        function changeEventHandler(event){
            if (!event.target.value)
                alert('Select an option');
            else
                document.getElementById("StateSelections").innerHTML = event.target.value;
                document.getElementById("StateSelections_nv").value = event.target.value;            
        }
    </script>

    <script>
        function getAllSelectedValues()
        {
            getMultipleSelectedValue('State');
            getMultipleSelectedValue('City');
        }
    </script>
    
    <!-- Script to get the values selected and display those on page as well set in the invisible form fields -->
    <!-- These values will get submitted as use clicked on the submit button -->    
    <script>
        function getMultipleSelectedValue(theElement)
        {
          switch (theElement){
          case 'State':
            var x=document.getElementById("stateList");
            break;
          case 'City':
            var x=document.getElementById("cityList");
            break;
          case 'Type':
            var x=document.getElementById("typeList");
            break;
          case 'Ranking':
            var x=document.getElementById("rankingList");
            break;
          case 'Cutoff':
            var x=document.getElementById("cutoffList");
            break;
          case 'Quota':
            var x=document.getElementById("quotaList");
            break;
          }  
          
          var selVals = "";
          var firstLoop = true;
          for (var i = 0; i < x.options.length; i++) {
             if(x.options[i].selected ==true){
             
                if(firstLoop){
                   selVals = x.options[i].value;
                   firstLoop = false;
                } else {   
                    selVals = selVals + "," + x.options[i].value;
                }
            }
          }
          switch (theElement){
          case 'State':
            document.getElementById("StateSelections").innerHTML = selVals;
            document.getElementById("StateSelections_nv").value = selVals;            
            break;
          case 'City':
            document.getElementById("CitySelections").innerHTML = selVals;
            document.getElementById("CitySelections_nv").value = selVals;
            break;
          case 'Type':
            document.getElementById("TypeSelections").innerHTML = selVals;
            document.getElementById("TypeSelections_nv").value = selVals;
            break;
          case 'Ranking':
            document.getElementById("RankingSelections").innerHTML = selVals;
            document.getElementById("RankingSelections_nv").value = selVals;
            break;
          case 'Cutoff':
            document.getElementById("CutoffSelections").innerHTML = selVals;
            document.getElementById("CutoffSelections_nv").value = selVals;
            break;
          case 'Quota':
            document.getElementById("QuotaSelections").innerHTML = selVals;
            document.getElementById("QuotaSelections_nv").value = selVals;
            break;
          }  
        }
    </script>


 <!--Script for the panel (Search Insturctions) -->
    <script>    
         $(document).on('click', '.panel-heading span.clickable', function (e) {
            var $this = $(this);
            if (!$this.hasClass('panel-collapsed')) {
                $this.parents('.panel').find('.panel-body').slideUp();
                $this.addClass('panel-collapsed');
                $this.find('i').removeClass('glyphicon-minus').addClass('glyphicon-plus');
            } else {
                $this.parents('.panel').find('.panel-body').slideDown();
                $this.removeClass('panel-collapsed');
                $this.find('i').removeClass('glyphicon-plus').addClass('glyphicon-minus');
            }
        });
        $(document).on('click', '.panel div.clickable', function (e) {
            var $this = $(this);
            if (!$this.hasClass('panel-collapsed')) {
                $this.parents('.panel').find('.panel-body').slideUp();
                $this.addClass('panel-collapsed');
                $this.find('i').removeClass('glyphicon-minus').addClass('glyphicon-plus');
            } else {
                $this.parents('.panel').find('.panel-body').slideDown();
                $this.removeClass('panel-collapsed');
                $this.find('i').removeClass('glyphicon-plus').addClass('glyphicon-minus');
            }
        });
        $(document).ready(function () {
            $('.panel-heading span.clickable').click();
            $('.panel div.clickable').click();
        });

    </script>


    
{% endblock features %}

{% block misson-statement %}
<!-- Nothing here, just override the block from parent -->
{% endblock misson-statement %}

{% block jointhem-blog %}
<!-- Nothing here, just override the block from parent -->
{% endblock jointhem-blog %}

<!-- Footer-section remains as it is, no override -->
